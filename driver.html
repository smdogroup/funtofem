
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>FUNtoFEM driver &#8212; FUNtoFEM .0 documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Transfer Scheme" href="transfer_scheme.html" />
    <link rel="prev" title="FUNtoFEM model" href="model.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="transfer_scheme.html" title="Transfer Scheme"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="model.html" title="FUNtoFEM model"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">FUNtoFEM .0 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">FUNtoFEM driver</a><ul>
<li><a class="reference internal" href="#creating-the-solver-dictionary">Creating the solver dictionary</a></li>
<li><a class="reference internal" href="#transfer-scheme-set-up">Transfer scheme set up</a><ul>
<li><a class="reference internal" href="#meld">MELD</a></li>
<li><a class="reference internal" href="#linearized-meld">Linearized MELD</a></li>
<li><a class="reference internal" href="#radial-basis-function">Radial Basis Function</a></li>
<li><a class="reference internal" href="#beam">Beam</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-the-driver">Running the driver</a></li>
<li><a class="reference internal" href="#setting-up-a-design-optimization">Setting up a design optimization</a></li>
<li><a class="reference internal" href="#driver-classes">Driver Classes</a><ul>
<li><a class="reference internal" href="#module-funtofem_driver">FUNtoFEM Driver Class</a></li>
<li><a class="reference internal" href="#funtofem-nlbgs-driver-class">FUNtoFEM NLBGS Driver Class</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="model.html"
                        title="previous chapter">FUNtoFEM model</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="transfer_scheme.html"
                        title="next chapter">Transfer Scheme</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="funtofem-driver">
<h1>FUNtoFEM driver<a class="headerlink" href="#funtofem-driver" title="Permalink to this headline">¶</a></h1>
<p>While the FUNtoFEM model holds a lot of the aeroelastic and design data, the driver is what solves the coupled problems.
The nonlinear block Gauss Seidel is the current driver.</p>
<p>To use the driver:</p>
<ol class="arabic simple">
<li>Create the solver dictionary</li>
<li>Set up the transfer scheme options</li>
<li>Instantiate the driver then call the run methods.</li>
</ol>
<div class="section" id="creating-the-solver-dictionary">
<h2>Creating the solver dictionary<a class="headerlink" href="#creating-the-solver-dictionary" title="Permalink to this headline">¶</a></h2>
<p>The disciplinary solvers in FUNtoFEM are a dictionary of the solver interface objects. The solver interface objects exchange data and ask the disciplinary solvers to do tasks like taking forward and adjoint interations and calculating coordinate derivatives.</p>
<p>Here’s some pseudocode to create the solvers for the NLBGS driver.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">solvers</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">solvers</span><span class="p">[</span><span class="s1">&#39;flow&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">flow_solver</span><span class="p">()</span>
<span class="n">solvers</span><span class="p">[</span><span class="s1">&#39;structural&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">structural_solver</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="transfer-scheme-set-up">
<h2>Transfer scheme set up<a class="headerlink" href="#transfer-scheme-set-up" title="Permalink to this headline">¶</a></h2>
<p>Several transfer schemes have been implemented in FUNtoFEM.
The transfer schemes are stored in the FUNtoFEM bodies.
Since each body in the model has it’s own transfer scheme instance, different bodies can use different schemes within the same model.
The transfer scheme for each is set up by the driver from a python dictionary of transfer scheme options.
If there are multiple bodies, the <em>transfer_scheme</em> argument in the driver can be a list of python dictionaries, one for each body.
If the argument is only one python dictionary but there are multiple bodies, the driver assumes all the bodies will use the same options.
If no transfer scheme options are provide, MELD with the default options is used for all the bodies.</p>
<div class="section" id="meld">
<h3>MELD<a class="headerlink" href="#meld" title="Permalink to this headline">¶</a></h3>
<p>The MELD scheme is the only scheme in FUNtoFEM that currently has implemented all of the derivatives necessary for shape derivatives in optimization.
The default options for MELD are:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transfer_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;scheme&#39;</span><span class="p">:</span><span class="s1">&#39;MELD&#39;</span><span class="p">}</span>

<span class="c1"># symmetry plane -1-&gt; no symmetry</span>
<span class="c1">#                 0-&gt; x=0 plane symmetry</span>
<span class="c1">#                 1-&gt; y=0 plane symmetry</span>
<span class="c1">#                 2-&gt; z=0 sym</span>
<span class="n">transfer_options</span><span class="p">[</span><span class="s1">&#39;isym&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="c1"># weighting function parameter. As lower values of beta -&gt; more equal weighting</span>
<span class="n">transfer_options</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="c1"># number of structural nodes each aerodynamic node is connected to</span>
<span class="n">transfer_options</span><span class="p">[</span><span class="s1">&#39;npts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">200</span>
</pre></div>
</div>
</div>
<div class="section" id="linearized-meld">
<h3>Linearized MELD<a class="headerlink" href="#linearized-meld" title="Permalink to this headline">¶</a></h3>
<p>The linearized version of MELD has a lower computational cost than the full version, but it also more error prone for larger deflections and extrapolations.
It cannot reproduce rigid motion, and should not be used for case such as rotors.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transfer_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;scheme&#39;</span><span class="p">:</span><span class="s1">&#39;linearized MELD&#39;</span><span class="p">}</span>

<span class="c1"># weighting function parameter. As lower values of beta -&gt; more equal weighting</span>
<span class="n">transfer_options</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="c1"># number of structural nodes each aerodynamic node is connected to</span>
<span class="n">transfer_options</span><span class="p">[</span><span class="s1">&#39;npts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">200</span>
</pre></div>
</div>
</div>
<div class="section" id="radial-basis-function">
<h3>Radial Basis Function<a class="headerlink" href="#radial-basis-function" title="Permalink to this headline">¶</a></h3>
<p>Radial basis function (RBF) interpolation is available in FUNtoFEM with various basis functions.</p>
<p>The options available for the RBF scheme are the different basis functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">transfer_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;scheme&#39;</span><span class="p">:</span><span class="s1">&#39;RBF&#39;</span><span class="p">}</span>

<span class="c1"># Available basis functions:</span>
<span class="c1"># &#39;thin plate spline&#39;</span>
<span class="c1"># &#39;gaussian&#39;</span>
<span class="c1"># &#39;multiquadric&#39;</span>
<span class="c1"># &#39;inverse multiquadric&#39;</span>
<span class="n">transfer_options</span><span class="p">[</span><span class="s1">&#39;basis function&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;thin plate spline&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="beam">
<h3>Beam<a class="headerlink" href="#beam" title="Permalink to this headline">¶</a></h3>
<p>The beam transfer scheme can transfer data when all of structural nodes are colinear.
The implemented version is based on the method of Brown.
Unlike the other transfer schemes, the beam transfer has six degrees of freedom at each structural node where the additional degrees of freedom are the Euler parameter vector for the rotation.
For the aerodynamic nodes, the force integration and displacement transfer still only three degrees of freedom.</p>
</div>
</div>
<div class="section" id="running-the-driver">
<h2>Running the driver<a class="headerlink" href="#running-the-driver" title="Permalink to this headline">¶</a></h2>
<p>Once the model, solver dictionary, transfer options are created, you can instantiate the driver and run the coupled forward and adjoint solvers.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span> <span class="o">=</span> <span class="n">FUNtoFEMnlbgs</span><span class="p">(</span><span class="n">solvers</span><span class="p">,</span> <span class="n">comm</span><span class="p">,</span> <span class="n">transfer_options</span><span class="p">,</span> <span class="n">model</span><span class="p">)</span>

<span class="n">fail</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">solve_forward</span><span class="p">()</span>

<span class="n">fail</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">solve_adjoint</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-up-a-design-optimization">
<h2>Setting up a design optimization<a class="headerlink" href="#setting-up-a-design-optimization" title="Permalink to this headline">¶</a></h2>
<p>See <a class="reference internal" href="model.html"><span class="doc">FUNtoFEM model</span></a> for explanation of using the driver and model class for a design optimization. There is also an example in the examples directory.</p>
</div>
<div class="section" id="driver-classes">
<h2>Driver Classes<a class="headerlink" href="#driver-classes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-funtofem_driver">
<span id="funtofem-driver-class"></span><h3>FUNtoFEM Driver Class<a class="headerlink" href="#module-funtofem_driver" title="Permalink to this headline">¶</a></h3>
<p>This file is part of the package FUNtoFEM for coupled aeroelastic simulation
and design optimization.</p>
<p>Copyright (C) 2015 Georgia Tech Research Corporation.
Additional copyright (C) 2015 Kevin Jacobson, Jan Kiviaho and Graeme Kennedy.
All rights reserved.</p>
<p>FUNtoFEM is licensed under the Apache License, Version 2.0 (the “License”);
you may not use this software except in compliance with the License.
You may obtain a copy of the License at</p>
<blockquote>
<div><a class="reference external" href="http://www.apache.org/licenses/LICENSE-2.0">http://www.apache.org/licenses/LICENSE-2.0</a></div></blockquote>
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an “AS IS” BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.</p>
<dl class="class">
<dt id="funtofem_driver.FUNtoFEMDriver">
<em class="property">class </em><code class="descclassname">funtofem_driver.</code><code class="descname">FUNtoFEMDriver</code><span class="sig-paren">(</span><em>solvers</em>, <em>comm</em>, <em>struct_comm</em>, <em>struct_master</em>, <em>aero_comm</em>, <em>aero_master</em>, <em>transfer_options=None</em>, <em>model=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/funtofem_driver.html#FUNtoFEMDriver"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#funtofem_driver.FUNtoFEMDriver" title="Permalink to this definition">¶</a></dt>
<dd><p>The FUNtoFEM driver base class has all of the driver except for the coupling algorithms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>solvers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – the various disciplinary solvers</li>
<li><strong>comm</strong> (<em>MPI.comm</em>) – MPI communicator</li>
<li><strong>transfer_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – options of the load and displacement transfer scheme</li>
<li><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">FUNtoFEMmodel</span></code>) – The model containing the design data</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="funtofem_driver.FUNtoFEMDriver.update_model">
<code class="descname">update_model</code><span class="sig-paren">(</span><em>model</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/funtofem_driver.html#FUNtoFEMDriver.update_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#funtofem_driver.FUNtoFEMDriver.update_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the model object that the driver sees</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>model</strong> (<em>FUNtoFEM model type</em>) – </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="funtofem_driver.FUNtoFEMDriver.solve_forward">
<code class="descname">solve_forward</code><span class="sig-paren">(</span><em>steps=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/funtofem_driver.html#FUNtoFEMDriver.solve_forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#funtofem_driver.FUNtoFEMDriver.solve_forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves the coupled forward problem</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) – number of coupled solver steps. Only for use if a FUNtoFEM model is not defined</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="funtofem_driver.FUNtoFEMDriver.solve_adjoint">
<code class="descname">solve_adjoint</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/funtofem_driver.html#FUNtoFEMDriver.solve_adjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#funtofem_driver.FUNtoFEMDriver.solve_adjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves the coupled adjoint problem and computes gradients</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="funtofem-nlbgs-driver-class">
<h3>FUNtoFEM NLBGS Driver Class<a class="headerlink" href="#funtofem-nlbgs-driver-class" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="transfer_scheme.html" title="Transfer Scheme"
             >next</a> |</li>
        <li class="right" >
          <a href="model.html" title="FUNtoFEM model"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">FUNtoFEM .0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, FUNtoFEM Developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>