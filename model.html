
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>FUNtoFEM Model &#8212; FUNtoFEM .1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinxdoc.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="FUNtoFEM Driver" href="driver.html" />
    <link rel="prev" title="Analysis Framework" href="analysis_framework.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="driver.html" title="FUNtoFEM Driver"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="analysis_framework.html" title="Analysis Framework"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">FUNtoFEM .1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">FUNtoFEM Model</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="funtofem-model">
<h1>FUNtoFEM Model<a class="headerlink" href="#funtofem-model" title="Permalink to this heading">¶</a></h1>
<p>The model classes are used to stored design and coupling data related to the aeroelastic problem.
The model is made up of <a class="reference internal" href="#bodies-and-scenarios">bodies and scenarios</a> .</p>
<figure class="align-default">
<img alt="_images/funtofem_model.png" src="_images/funtofem_model.png" />
</figure>
<p>The bodies are the different bodies in the simulations, such as the blades of a rotor.
The scenarios are the different points of a multipoint optimization.</p>
<p>Methods on this page with <strong>[driver call]</strong> and <strong>[model call]</strong> are calls that the user does not make directly and can be ignored.</p>
<section id="assembling-the-model">
<h2>Assembling the model<a class="headerlink" href="#assembling-the-model" title="Permalink to this heading">¶</a></h2>
<p>One way to build a model is by using the <code class="xref py py-func docutils literal notranslate"><span class="pre">add_body()</span></code> and
<code class="xref py py-func docutils literal notranslate"><span class="pre">add_scenario()</span></code> calls. New class methods are available for these classes
which provide shortcuts to their creation. See <a class="reference internal" href="#bodies-and-scenarios">bodies and scenarios</a> for details about their creation.</p>
<p>The bodies and scenarios are kept in lists in the same order that they are input.</p>
</section>
<section id="exchanging-the-model-data-with-an-optimizer">
<h2>Exchanging the model data with an optimizer<a class="headerlink" href="#exchanging-the-model-data-with-an-optimizer" title="Permalink to this heading">¶</a></h2>
<p>The model object provides a convenient way to exchange data with a python-based optimizer.</p>
<section id="design-variables">
<h3>Design variables<a class="headerlink" href="#design-variables" title="Permalink to this heading">¶</a></h3>
<p>The assembled model contains all the design variables information that an optimizer such as PyOpt needs.
A list of the active design for the entire model is returned by <code class="xref py py-func docutils literal notranslate"><span class="pre">get_variables()</span></code>.
The output list contains the <code class="xref py py-class docutils literal notranslate"><span class="pre">variable</span></code> type. Here is an example of passing the
variable information from the model to a PyOpt optimizer:</p>
<p><strong>The variables are stored in the model as a dictionary.</strong>
<strong>They return in of ordered list of scenarios in the order they were added to the model,
then the bodies in the order that they were added. Within each scenario and body,
the order is alphabetical by variable type. Within each variable type, the variables are
in the order added to the body/scenario.</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pyOpt</span> <span class="kn">import</span> <span class="n">Optimization</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">opt_prob</span> <span class="o">=</span> <span class="n">Optimization</span><span class="p">(</span><span class="s1">&#39;optimization&#39;</span><span class="p">,</span><span class="n">design_problem</span><span class="o">.</span><span class="n">eval_obj_con</span><span class="p">)</span>
<span class="n">variables</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_variables</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
    <span class="n">opt_prob</span><span class="o">.</span><span class="n">addVar</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">var</span><span class="o">.</span><span class="n">value</span><span class="o">/</span><span class="n">var</span><span class="o">.</span><span class="n">scaling</span><span class="p">,</span>
                                      <span class="n">lower</span><span class="o">=</span><span class="n">var</span><span class="o">.</span><span class="n">lower</span><span class="o">/</span><span class="n">var</span><span class="o">.</span><span class="n">scaling</span><span class="p">,</span>
                                      <span class="n">upper</span><span class="o">=</span><span class="n">var</span><span class="o">.</span><span class="n">upper</span><span class="o">/</span><span class="n">var</span><span class="o">.</span><span class="n">scaling</span><span class="p">)</span>
</pre></div>
</div>
<p>Optimizers such as PyOpt will typically provide a list of new values at each design point.
These can be set back into model type using <code class="xref py py-func docutils literal notranslate"><span class="pre">set_variables()</span></code>.
The variables can be pre-scaled and passed directing into this call, or with the scale argument set to
True, the scaling will be done automatically.</p>
</section>
<section id="function-values">
<h3>Function values<a class="headerlink" href="#function-values" title="Permalink to this heading">¶</a></h3>
<p>Once the driver has been run, <code class="xref py py-func docutils literal notranslate"><span class="pre">solve_forward()</span></code>, the functions can be
retrieved using <code class="xref py py-func docutils literal notranslate"><span class="pre">get_functions()</span></code>.
The output list contains the <code class="xref py py-class docutils literal notranslate"><span class="pre">function</span></code> type. The following code prints the function values:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">driver</span><span class="o">.</span><span class="n">solve_forward</span><span class="p">()</span>
<span class="n">functions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_functions</span><span class="p">()</span>

<span class="nb">print</span> <span class="s2">&quot;Function values:&quot;</span>
<span class="k">for</span> <span class="n">function</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
    <span class="nb">print</span> <span class="n">function</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">function</span><span class="o">.</span><span class="n">value</span>
</pre></div>
</div>
<p>The functions in the FUNtoFEM model need to be single discipline functions to maintain modularity.
The following pseudo code lays out a function that can be used as an objective evaluation with PyObj:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">eval_obj_con</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">fail</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">model</span><span class="o">.</span><span class="n">set_variables</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fail</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">solve_forward</span><span class="p">()</span>
    <span class="n">functions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_functions</span><span class="p">()</span>

    <span class="c1"># Manipulate/scale/combine single discipline functions</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">XXXXX</span>
    <span class="n">con</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">YYYYY</span>

    <span class="k">return</span> <span class="n">obj</span><span class="p">,</span> <span class="n">con</span><span class="p">,</span> <span class="n">fail</span>
</pre></div>
</div>
</section>
<section id="gradients">
<h3>Gradients<a class="headerlink" href="#gradients" title="Permalink to this heading">¶</a></h3>
<p>The derivatives in the model class are populated by <code class="xref py py-func docutils literal notranslate"><span class="pre">solve_adjoint()</span></code>.
Gradients can be retrieved using <code class="xref py py-func docutils literal notranslate"><span class="pre">get_function_gradients()</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">variables</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_variables</span><span class="p">()</span>

<span class="n">driver</span><span class="o">.</span><span class="n">solve_forward</span><span class="p">()</span>
<span class="n">functions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_functions</span><span class="p">()</span>

<span class="n">fail</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">solve_adjoint</span><span class="p">()</span>
<span class="n">grad</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_functions_gradients</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ifunc</span><span class="p">,</span><span class="n">func</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">functions</span><span class="p">):</span>
           <span class="k">for</span> <span class="n">ivar</span><span class="p">,</span><span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
               <span class="nb">print</span> <span class="s1">&#39;Derivative of &#39;</span><span class="p">,</span> <span class="n">func</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;w.r.t.&#39;</span><span class="p">,</span> <span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="p">,</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="n">grad</span><span class="p">[</span><span class="n">ifunc</span><span class="p">][</span><span class="n">ivar</span><span class="p">]</span>
</pre></div>
</div>
<p>The following is a pseudo code would be a gradient evaluation for pyOpt.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">eval_obj_con_grad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">obj</span><span class="p">,</span><span class="n">con</span><span class="p">)</span>

    <span class="n">fail</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># get the scaling values</span>
    <span class="n">variables</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_variables</span><span class="p">()</span>
    <span class="n">var_scale</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables</span><span class="p">:</span>
        <span class="n">var_scaling</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">scale</span><span class="p">)</span>

    <span class="c1"># solve the adjoint problem</span>
    <span class="n">fail</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">solve_adjoint</span><span class="p">()</span>
    <span class="n">grad</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_functions_gradients</span><span class="p">()</span>

    <span class="c1"># use the chain / automatic differentiation to get the composite function derivatives</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">dobj</span><span class="o">/</span><span class="n">dfunc0</span> <span class="o">*</span> <span class="n">grad</span><span class="p">[</span><span class="mi">0</span><span class="p">][:]</span> <span class="o">*</span><span class="n">variable_scaling</span> <span class="o">+</span> <span class="n">dobj</span><span class="o">/</span><span class="n">dfunc1</span> <span class="o">*</span> <span class="n">grad</span><span class="p">[</span><span class="mi">1</span><span class="p">][:]</span> <span class="o">*</span> <span class="n">variable_scaling</span> <span class="o">+</span> <span class="o">...</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">YYYYY</span>

    <span class="k">return</span> <span class="n">g</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">fail</span>
</pre></div>
</div>
</section>
<section id="funtofem-model-class">
<h3>FUNtoFEM Model Class<a class="headerlink" href="#funtofem-model-class" title="Permalink to this heading">¶</a></h3>
<dl class="py class">
<dt class="sig sig-object py" id="funtofem.model.FUNtoFEMmodel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">funtofem.model.</span></span><span class="sig-name descname"><span class="pre">FUNtoFEMmodel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#funtofem.model.FUNtoFEMmodel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
</section>
<section id="bodies-and-scenarios">
<h2>Bodies and Scenarios<a class="headerlink" href="#bodies-and-scenarios" title="Permalink to this heading">¶</a></h2>
<p>Bodies and scenarios organize the data associated for the coupling and design.
Additionally, the body class holds the shape parameterization and transfer scheme.
Shape parameterization is added by creating a new body class that subclasses the <code class="xref py py-class docutils literal notranslate"><span class="pre">body</span></code> class.
See <code class="xref py py-class docutils literal notranslate"><span class="pre">MassoudBody</span></code> for an example.
The driver adds the details for the transfer scheme. See <code class="xref py py-class docutils literal notranslate"><span class="pre">FUNtoFEMDriver</span></code>.</p>
<section id="scenarios">
<h3>Scenarios<a class="headerlink" href="#scenarios" title="Permalink to this heading">¶</a></h3>
<p>Scenarios hold <a class="reference internal" href="#variables">variables</a> and <a class="reference internal" href="#functions">functions</a> in lists.
Variables and functions are added using <code class="xref py py-func docutils literal notranslate"><span class="pre">add_function()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">add_variable()</span></code>.</p>
<p>An example of a scenario variable could be flow variables such as angle of attack or Mach number.</p>
<figure class="align-default">
<img alt="_images/scenario.png" src="_images/scenario.png" />
</figure>
<dl class="py class">
<dt class="sig sig-object py" id="funtofem.model.scenario.Scenario">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">funtofem.model.scenario.</span></span><span class="sig-name descname"><span class="pre">Scenario</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#funtofem.model.scenario.Scenario" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="bodies">
<h3>Bodies<a class="headerlink" href="#bodies" title="Permalink to this heading">¶</a></h3>
<p>Shape parameterization is added by creating a new body class that subclasses the <code class="xref py py-class docutils literal notranslate"><span class="pre">body</span></code> class.
See <code class="xref py py-class docutils literal notranslate"><span class="pre">MassoudBody</span></code> for an example.
The driver adds the details for the transfer scheme. See <code class="xref py py-class docutils literal notranslate"><span class="pre">FUNtoFEMDriver</span></code>.</p>
<p>The aero_loads array is of size 3 x aero_nnodes.</p>
<figure class="align-default">
<img alt="_images/body.png" src="_images/body.png" />
</figure>
<dl class="py class">
<dt class="sig sig-object py" id="funtofem.model.body.Body">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">funtofem.model.body.</span></span><span class="sig-name descname"><span class="pre">Body</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#funtofem.model.body.Body" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<table class="docutils align-center" id="id1">
<caption><span class="caption-text"><strong>Body Member List</strong></span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Default Value</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>self.name</p></td>
<td><p>Required Input</p></td>
<td><p>Name</p></td>
</tr>
<tr class="row-odd"><td><p>self.analysis_type</p></td>
<td><p>Required Input</p></td>
<td><p>Analysis type (aeroelastic, aerothermal, aerothermoelastic)</p></td>
</tr>
<tr class="row-even"><td><p>self.id</p></td>
<td><p>Required Input</p></td>
<td><p>ID</p></td>
</tr>
<tr class="row-odd"><td><p>self.group</p></td>
<td><p>Required Input</p></td>
<td><p>Group categorization</p></td>
</tr>
<tr class="row-even"><td><p>self.group_master</p></td>
<td><p>False</p></td>
<td><p>Top-level body group</p></td>
</tr>
<tr class="row-odd"><td><p>self.boundary</p></td>
<td><p>0.0</p></td>
<td><p>Body boundary</p></td>
</tr>
<tr class="row-even"><td><p>self.motion_type</p></td>
<td><p>deform</p></td>
<td><p>Motion type</p></td>
</tr>
<tr class="row-odd"><td><p>self.variables</p></td>
<td><p>{}</p></td>
<td><p>Owned variables</p></td>
</tr>
<tr class="row-even"><td><p>self.derivatives</p></td>
<td><p>{}</p></td>
<td><p>Owned derivatives</p></td>
</tr>
<tr class="row-odd"><td><p>self.parent</p></td>
<td><p>None</p></td>
<td><p>Body parent</p></td>
</tr>
<tr class="row-even"><td><p>self.children</p></td>
<td><p>[]</p></td>
<td><p>Owned bodies</p></td>
</tr>
<tr class="row-odd"><td><p>self.shape</p></td>
<td><p>None</p></td>
<td><p>Shape</p></td>
</tr>
<tr class="row-even"><td><p>self.parameterization</p></td>
<td><p>1.0</p></td>
<td><p>Geometry type</p></td>
</tr>
<tr class="row-odd"><td><p>self.transfer</p></td>
<td><p>None</p></td>
<td><p>Transfer method</p></td>
</tr>
<tr class="row-even"><td><p>self.thermal_transfer</p></td>
<td><p>None</p></td>
<td><p>Thermal transfer method</p></td>
</tr>
<tr class="row-odd"><td><p>self.struct_nnodes</p></td>
<td><p>None</p></td>
<td><p>Number of structural nodes</p></td>
</tr>
<tr class="row-even"><td><p>self.aero_nnodes</p></td>
<td><p>None</p></td>
<td><p>Number of aerodynamic nodes</p></td>
</tr>
<tr class="row-odd"><td><p>self.xfer_ndof</p></td>
<td><p>3.0</p></td>
<td><p>Variable degree of freedom</p></td>
</tr>
<tr class="row-even"><td><p>self.therm_xfer_ndof</p></td>
<td><p>1.0</p></td>
<td><p>Thermal variable degree of freedom</p></td>
</tr>
<tr class="row-odd"><td><p>self.T_ref</p></td>
<td><p>300</p></td>
<td><p>Reference temperature</p></td>
</tr>
<tr class="row-even"><td><p>self.struct_X</p></td>
<td><p>None</p></td>
<td><p>Structural variables</p></td>
</tr>
<tr class="row-odd"><td><p>self.aero_X</p></td>
<td><p>None</p></td>
<td><p>Aerodynamic variables</p></td>
</tr>
<tr class="row-even"><td><p>self.struct_id</p></td>
<td><p>None</p></td>
<td><p>Structural ID</p></td>
</tr>
<tr class="row-odd"><td><p>self.aero_id</p></td>
<td><p>None</p></td>
<td><p>Aerodynamic ID</p></td>
</tr>
<tr class="row-even"><td><p>self.struct_disps</p></td>
<td><p>None</p></td>
<td><p>Structural displacements</p></td>
</tr>
<tr class="row-odd"><td><p>self.struct_forces</p></td>
<td><p>None</p></td>
<td><p>Structural forces</p></td>
</tr>
<tr class="row-even"><td><p>self.struct_loads</p></td>
<td><p>None</p></td>
<td><p>Structural loads</p></td>
</tr>
<tr class="row-odd"><td><p>self.rigid_transform</p></td>
<td><p>None</p></td>
<td><p>Body transformation scheme</p></td>
</tr>
<tr class="row-even"><td><p>self.aero_disps</p></td>
<td><p>None</p></td>
<td><p>Aerodynamic displacements</p></td>
</tr>
<tr class="row-odd"><td><p>self.aero_forces</p></td>
<td><p>None</p></td>
<td><p>Aerodynamic forces</p></td>
</tr>
<tr class="row-even"><td><p>self.aero_loads</p></td>
<td><p>None</p></td>
<td><p>Aerodynamic loads</p></td>
</tr>
<tr class="row-odd"><td><p>self.struct_temps</p></td>
<td><p>None</p></td>
<td><p>Structural temperature</p></td>
</tr>
<tr class="row-even"><td><p>self.struct_heat_flux</p></td>
<td><p>None</p></td>
<td><p>Structural heat flux</p></td>
</tr>
<tr class="row-odd"><td><p>self.aero_temps</p></td>
<td><p>None</p></td>
<td><p>Aerodynamic temperature</p></td>
</tr>
<tr class="row-even"><td><p>self.aero_heat_flux</p></td>
<td><p>None</p></td>
<td><p>Aerodynamic heat flux</p></td>
</tr>
</tbody>
</table>
</section>
<section id="base-class">
<h3>Base class<a class="headerlink" href="#base-class" title="Permalink to this heading">¶</a></h3>
<p>The body and scenario classes subclass the <a class="reference internal" href="#base-class">base class</a>.</p>
<p>Although most of the methods in the base class are used internally in the model, <code class="xref py py-func docutils literal notranslate"><span class="pre">set_variable()</span></code>
allows the user to change attributes of existing <a class="reference internal" href="#variables">variables</a> in the body or scenario.
For example, if the shape parameterization created a specific number of variables, but you do not want to use all
of them in the optimization, you can set the variable to be inactive.</p>
<dl class="py class">
<dt class="sig sig-object py" id="funtofem.model.Base">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">funtofem.model.</span></span><span class="sig-name descname"><span class="pre">Base</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#funtofem.model.Base" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="massoudbody">
<h3>MassoudBody<a class="headerlink" href="#massoudbody" title="Permalink to this heading">¶</a></h3>
</section>
<section id="variables">
<h3>Variables<a class="headerlink" href="#variables" title="Permalink to this heading">¶</a></h3>
<p>Some solvers like FUN3D require some design variables to be defined, whether or not it is being used in design.
The active attribute of the <code class="xref py py-class docutils literal notranslate"><span class="pre">Variable</span></code> class. Setting it to False, allows you to still define
the variable but it won’t be returned when calling <code class="xref py py-func docutils literal notranslate"><span class="pre">get_variables()</span></code>.
When the variable is added to a <a class="reference internal" href="#funtofem.model.scenario.Scenario" title="funtofem.model.scenario.Scenario"><code class="xref py py-class docutils literal notranslate"><span class="pre">Scenario</span></code></a> or <a class="reference internal" href="#funtofem.model.body.Body" title="funtofem.model.body.Body"><code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code></a> using <code class="xref py py-func docutils literal notranslate"><span class="pre">add_variable()</span></code>,
the vartype argument specifies what discipline the variable is associated with.</p>
<dl class="py class">
<dt class="sig sig-object py" id="funtofem.model.Variable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">funtofem.model.</span></span><span class="sig-name descname"><span class="pre">Variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#funtofem.model.Variable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this heading">¶</a></h3>
<p>Functions in the FUNtoFEM framework are single discipline functions.
The <em>analysis_type</em> argument specifics which discipline the function is associated with.
Currently the options are ‘aerodynamic’ and ‘structural’.</p>
<p>Once the function is instantiated, <code class="xref py py-class docutils literal notranslate"><span class="pre">add_function</span></code> is used to add it to a scenario.
Although the function values could be accessed from the model type, <code class="xref py py-func docutils literal notranslate"><span class="pre">get_functions()</span></code>
will return all the <a class="reference internal" href="#functions">functions</a> defined in the model.</p>
<p>When FUNtoFEM is used with FUN3D, the name of any function that would be defined in the rubber.data can be used.
For functions that do not need an adjoint, such as structural mass, the boolean, adjoint, should be set to false.
Some functions are associated with particular bodies, for instance, if you wanted the thrust or torque of a rotor
without including that of the sting model, you can use the body argument to pass that information to the solver.</p>
<dl class="py class">
<dt class="sig sig-object py" id="funtofem.model.Function">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">funtofem.model.</span></span><span class="sig-name descname"><span class="pre">Function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#funtofem.model.Function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">FUNtoFEM Model</a><ul>
<li><a class="reference internal" href="#assembling-the-model">Assembling the model</a></li>
<li><a class="reference internal" href="#exchanging-the-model-data-with-an-optimizer">Exchanging the model data with an optimizer</a><ul>
<li><a class="reference internal" href="#design-variables">Design variables</a></li>
<li><a class="reference internal" href="#function-values">Function values</a></li>
<li><a class="reference internal" href="#gradients">Gradients</a></li>
<li><a class="reference internal" href="#funtofem-model-class">FUNtoFEM Model Class</a></li>
</ul>
</li>
<li><a class="reference internal" href="#bodies-and-scenarios">Bodies and Scenarios</a><ul>
<li><a class="reference internal" href="#scenarios">Scenarios</a></li>
<li><a class="reference internal" href="#bodies">Bodies</a></li>
<li><a class="reference internal" href="#base-class">Base class</a></li>
<li><a class="reference internal" href="#massoudbody">MassoudBody</a></li>
<li><a class="reference internal" href="#variables">Variables</a></li>
<li><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="analysis_framework.html"
                          title="previous chapter">Analysis Framework</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="driver.html"
                          title="next chapter">FUNtoFEM Driver</a></p>
  </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="driver.html" title="FUNtoFEM Driver"
             >next</a> |</li>
        <li class="right" >
          <a href="analysis_framework.html" title="Analysis Framework"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">FUNtoFEM .1 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">FUNtoFEM Model</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, FUNtoFEM Developers.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.0.2.
    </div>
  </body>
</html>